---
title: "J Graph"
output:
  html_document: default
  pdf_document: default
---


Clear 
```{r}
rm(list = ls())
```


```{r setup}
#install.packages("remotes")
#Sys.setenv("R_REMOTES_NO_ERRORS_FROM_WARNINGS" = "true")
#remotes::install_github("orange-vertex/rdepthmap")
library(rdepthmap)
library(rgeos)
library(rgdal)
library(maptools)
library(devtools)
library(dplyr)
library(tidyverse)
library(sjmisc)
library(seqHMM) 
library(ggplot2)
library(spatstat)
library(reshape2)
library(networkD3)
library(xml2)
library(rvest)
library(tidyverse)  
library(stringr)   
library(lubridate)
library(data.table)
library(network)
library(sjmisc)
library(igraph)

#install.packages("https://cran.r-project.org/src/contrib/rlang_0.4.11.tar.gz", repos = NULL, type="source")

```


Read Diagrams
```{r include=FALSE}
data_ = read.csv("Connectivity_6.3.csv") %>% filter (status == "Old") %>% filter (weight == 1) 
data = data_ %>% filter (weight == 1) %>% select(source,target,weight,directed)


newdata_ = read.csv("Connectivity_6.3.csv") %>% filter (weight == 1) 
```

_____RESEARCH_____

Network by Block
```{r eval=FALSE, fig.asp=, fig.length=50, fig.width=50, include=FALSE}

g1 <- graph_from_data_frame(d=newdata_,directed = FALSE)
l = layout_as_tree(g1,flip.y=TRUE,root= "(A2) Main Lobby L2", circular = TRUE)

#plot(g1,layout=l, Vertex.label = NA)

#Edge Color
E(g1)$color <- 'black'
E(g1)$color[E(g1)$BlockConn != "-"] <- 'orange'
E(g1)$color[E(g1)$Staircase != "-"] <- 'orange'

#Node Color 
a = grep("(A1)|(A2)|(A3)|(A4)|(A5)|(A6)",V(g1)$name)
b = grep("(B1)|(B2)|(B3)|(B4)|(B5)|(B6)",V(g1)$name)
c = grep("(C1)|(C2)|(C3)|(C4)|(C5)|(C6)",V(g1)$name)
d = grep("(D1)|(D2)|(D3)|(D4)|(D5)|(D6)",V(g1)$name)
e = grep("(E1)|(E2)|(E3)|(E4)|(E5)|(E6)",V(g1)$name)
w = grep("(W1)|(W2)|(W3)|(W4)|(W5)|(W6)",V(g1)$name)
entrance = grep("Visitor Car|Drop-Off|Drop|Sheltered" ,V(g1)$name)


V(g1)$color<-"black"
V(g1)[a]$color<-"red"
V(g1)[b]$color<-"mediumpurple3"
V(g1)[c]$color<-"deepskyblue3"
V(g1)[d]$color<-"orange"
V(g1)[e]$color<-"hotpink2"
V(g1)[w]$color<-"olivedrab3"
V(g1)[entrance]$color<-"black"

```


Calculate Centrality Measures

```{r eval=FALSE, fig.asp=, fig.length=50, fig.width=50, include=FALSE}

#extract centrality measures     
btw = betweenness(g1, v = V(g1), directed = FALSE, weights = NULL,
  nobigint = TRUE, normalized = TRUE)
cls = closeness(g1, v = V(g1), weights = NULL, normalized = TRUE)
deg = degree(g1)
eig = evcent(g1)$vector



#create dataframe
btw_df = as.data.frame(btw)
cls_df = as.data.frame(cls)
deg_df = as.data.frame(deg)
eig_df = as.data.frame(eig)

#bind dataframes
cent_df = setNames(cbind(rownames(btw_df), btw_df, cls_df, deg_df, eig_df, row.names = NULL), 
         c("Name", "Betweenness", "Closeness","Degree","Eigenvector"))

```


1) Betweeness - Spaces with greatest potential for Through Movements (Spine)
2) Closeness - Spaces that are Easiest to Reach (Physical Centres)
3) Degree - Local Connectivity (Hallways)
4) Eigenvector - Spaces which are connected to more other Important Spaces (Hierachy of Spaces)



Plot All Centralities
```{r eval=FALSE, fig.asp=, fig.length=50, fig.width=50, include=FALSE}
#betweeness
plot.btw = function(){
  nsize.btw <-setNames((cent_df$Betweenness+0.03)*30,cent_df$name)
  plot(g1, layout = layout_with_kk(g1)*0.7, label.cex = 0.5, vertex.size = nsize.btw, vertex.label.color = "darkgrey") + title("Degree Centrality")
}

#closeness (physical centre)
plot.cls = function(){
  nsize.cls <-setNames( ((cent_df$Closeness)^3)*2000,cent_df$name)
  plot(g1, layout = layout_with_kk(g1)*0.7, label.cex = 0.5, vertex.size = nsize.cls, vertex.label.color = "darkgrey") + title("Closeness Centrality")
}

#degree (central corridors)
plot.deg = function(){
  nsize.deg <-setNames(cent_df$Degree/2,cent_df$name)
  plot(g1, layout = layout_with_kk(g1)*0.7, label.cex = 0.5, vertex.size = nsize.deg, vertex.label.color = "darkgrey") + title("Degree Centrality")
}

#eigenvector (heirachy of spaces, most prime areas)
plot.eig = function(){
  nsize.eig <-setNames( ((cent_df$Eigenvector)^0.8)*8,cent_df$name)
  plot(g1, layout = layout_with_kk(g1)*0.7, label.cex = 0.5, vertex.size = nsize.eig, vertex.label.color = "darkgrey") + title("Eigenvector Centrality")
}

```

```{r}

max(cent_df$Betweenness)

```


#save diagrams (high res)

```{r}
tiff(filename="Jgraph_btw.tiff", width=10, height=10, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)
plot.btw()
dev.off()

tiff(filename="Jgraph_cls.tiff", width=10, height=10, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)
plot.cls()
dev.off()

tiff(filename="Jgraph_deg.tiff", width=10, height=10, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)
plot.deg()
dev.off()

tiff(filename="Jgraph_eig.tiff", width=10, height=10, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)
plot.eig()
dev.off()
```

#save diagrams (png lower res)
```{r}
png(filename="Jgraph_btw.png", width=3000, height=3000, bg="white", res=300, pointsize=4)
plot.btw()
dev.off()

png(filename="Jgraph_cls.png", width=3000, height=3000, bg="white", res=300, pointsize=4)
plot.cls()
dev.off()

png(filename="Jgraph_deg.png", width=3000, height=3000, bg="white", res=300, pointsize=4)
plot.deg()
dev.off()

png(filename="Jgraph_eig.png", width=3000, height=3000, bg="white", res=300, pointsize=4)
plot.eig()
dev.off()
```






Betweeness at different intervals

```{r eval=FALSE, fig.asp=, fig.length=50, fig.width=50, include=FALSE}

btw = estimate_betweenness(g1, v = V(g1), directed = FALSE, weights = NULL,
  nobigint = TRUE, cutoff = 8)

cls = estimate_closeness(g1, v= V(g1), normalized = TRUE, cutoff = 10)

btw_df = as.data.frame(btw)
cls_df = as.data.frame(cls)

test_df = setNames(cbind(rownames(btw_df), btw_df, cls_df, deg_df, eig_df, row.names = NULL), 
         c("Name", "Betweenness", "Closeness","Degree","Eigenvector"))


nsize.trial <-setNames((test_df$Betweenness+0.03)/500,test_df$name)

nsize.cls <-setNames( ((cent_df$Closeness)^3)*2000,cent_df$name)


plot(g1, layout = layout_with_kk(g1)*0.7, label.cex = 0.5, vertex.size = nsize.trial, vertex.label.color = "darkgrey") + title("Degree Centrality")


```


















Plot by Closeness
```{r eval=FALSE, fig.asp=, fig.length=50, fig.width=50, include=FALSE}
#------------------------------ Betweeness Kamada Kawai

#tiff(filename="(NEW) Betweeness by Block.tiff", width=10, height=10, units="in",
#     pointsize=4, compression="lzw", bg="white", res=600,
#     restoreConsole=TRUE)
     
cls = closeness(g1, v = V(g1), weights = NULL, normalized = TRUE)

cls_df = as.data.frame(cls)
bet_df = setNames(cbind(rownames(bet_df), bet_df, row.names = NULL), 
         c("Name", "Betweenness"))

bet_df$Betweenness  = bet_df$Betweenness + 0.03

node.size<-setNames(bet_df$Betweenness*30,bet_df$name)

plot(g1, layout = layout_with_kk(g1)*0.7, label.cex = 0.5, vertex.size = node.size,vertex.label.color = "darkgrey")

#dev.off()

```


Plot by Degree Centrality


Ideas: 1) Extract average hallway connection to classrooms.. Get parent node, and count centrality






















___Old Code____


```{r eval=FALSE, fig.asp=, fig.length=50, fig.width=50, include=FALSE}
g1 <- graph_from_data_frame(d=data_,directed = FALSE)
l = layout_as_tree(g1,flip.y=TRUE,root= "(A2) Main Lobby L2", circular = TRUE)

#plot(g1,layout=l, Vertex.label = NA)

#Edge Color
E(g1)$color <- 'black'
E(g1)$color[E(g1)$BlockConn != "-"] <- 'orange'
E(g1)$color[E(g1)$Staircase != "-"] <- 'orange'

#Node Color 
classroom = grep("Classroom",V(g1)$name)
facil = grep("Pool|Hall|Field|Canteen" ,V(g1)$name)
labs = grep("Play|Cafe|Lab|Suite|PlayCourt|PlayArea|Science|Design|Drama|Practice" ,V(g1)$name)
#facil = grep("Pool|Play|Cafe|Lab|Hall|Suite|PlayCourt|PlayArea|Science|Design|Drama|Practice|Field|Canteen" ,V(g1)$name)
entrance = grep("Visitor Car|Drop-Off|Drop|Sheltered" ,V(g1)$name)


V(g1)$color<-"blue"
V(g1)[classroom]$color<-"red"
V(g1)[labs]$color<-"violet"
V(g1)[facil]$color<-"green"
V(g1)[entrance]$color<-"cyan"
#Plot



tiff(filename="f_Network Plot (kk).tiff", width=7, height=7, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)

plot(g1, layout = layout_with_kk(g1)*0.6, vertex.size = 2)


dev.off()

tiff(filename="f_Network Plot (nicely).tiff", width=7, height=7, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)

plot(g1, layout = layout_nicely, vertex.size = 2)


dev.off()


tiff(filename="f_Network Plot (fr).tiff", width=7, height=7, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)

plot(g1, layout = layout_with_fr(g1), vertex.size = 2)


dev.off()
```



```{r eval=FALSE, fig.asp=, fig.length=50, fig.width=50, include=FALSE}
g1 <- graph_from_data_frame(d=data_,directed = FALSE)
l = layout_as_tree(g1,flip.y=TRUE,root= "(A2) Main Lobby L2", circular = TRUE)

#plot(g1,layout=l, Vertex.label = NA)

#Edge Color
E(g1)$color <- 'black'
E(g1)$color[E(g1)$BlockConn != "-"] <- 'orange'
E(g1)$color[E(g1)$Staircase != "-"] <- 'orange'

#Node Color 
a = grep("(A1)|(A2)|(A3)|(A4)|(A5)|(A6)",V(g1)$name)
b = grep("(B1)|(B2)|(B3)|(B4)|(B5)|(B6)",V(g1)$name)
c = grep("(C1)|(C2)|(C3)|(C4)|(C5)|(C6)",V(g1)$name)
d = grep("(D1)|(D2)|(D3)|(D4)|(D5)|(D6)",V(g1)$name)
entrance = grep("Visitor Car|Drop-Off|Drop|Sheltered" ,V(g1)$name)


V(g1)$color<-"black"
V(g1)[a]$color<-"red"
V(g1)[b]$color<-"green"
V(g1)[c]$color<-"blue"
V(g1)[d]$color<-"orange"
V(g1)[entrance]$color<-"black"
#Plot


##plot(g1, layout=l, vertex.size=3, vertex.label.family="", vertex.label.dist=0.7, vertex.label.degree=90)
#plot(g1, layout = l, vertex.size = 1)
tiff(filename="b_Network Plot (kk).tiff", width=7, height=7, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)

plot(g1, layout = layout_with_kk(g1)*0.6, vertex.size = 2)


dev.off()

tiff(filename="b_Network Plot (nicely).tiff", width=7, height=7, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)

plot(g1, layout = layout_nicely, vertex.size = 2)


dev.off()


tiff(filename="b_Network Plot (fr).tiff", width=7, height=7, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)

plot(g1, layout = layout_with_fr(g1), vertex.size = 2)


dev.off()

```








NEWSCHOOL_BETWEENESS_BY BLOCK

```{r}

g1 <- graph_from_data_frame(d=newdata_,directed = FALSE)
l = layout_as_tree(g1,flip.y=TRUE,root= "(A2) Main Lobby L2", circular = TRUE)

#plot(g1,layout=l, Vertex.label = NA)

#Edge Color
E(g1)$color <- 'black'
E(g1)$color[E(g1)$BlockConn != "-"] <- 'orange'
E(g1)$color[E(g1)$Staircase != "-"] <- 'orange'

#Node Color 
a = grep("(A1)|(A2)|(A3)|(A4)|(A5)|(A6)",V(g1)$name)
b = grep("(B1)|(B2)|(B3)|(B4)|(B5)|(B6)",V(g1)$name)
c = grep("(C1)|(C2)|(C3)|(C4)|(C5)|(C6)",V(g1)$name)
d = grep("(D1)|(D2)|(D3)|(D4)|(D5)|(D6)",V(g1)$name)
e = grep("(E1)|(E2)|(E3)|(E4)|(E5)|(E6)",V(g1)$name)
w = grep("(W1)|(W2)|(W3)|(W4)|(W5)|(W6)",V(g1)$name)
entrance = grep("Visitor Car|Drop-Off|Drop|Sheltered" ,V(g1)$name)


V(g1)$color<-"black"
V(g1)[a]$color<-"red"
V(g1)[b]$color<-"mediumpurple3"
V(g1)[c]$color<-"deepskyblue3"
V(g1)[d]$color<-"orange"
V(g1)[e]$color<-"hotpink2"
V(g1)[w]$color<-"olivedrab3"
V(g1)[entrance]$color<-"black"
#Plot


#------------------------------ Betweeness Kamada Kawai

tiff(filename="(NEW) Betweeness by Block.tiff", width=10, height=10, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)
     
bet = betweenness(g1, v = V(g1), directed = FALSE, weights = NULL,
  nobigint = TRUE, normalized = TRUE)

bet_df = as.data.frame(bet)
bet_df = setNames(cbind(rownames(bet_df), bet_df, row.names = NULL), 
         c("Name", "Betweenness"))

bet_df$Betweenness  = bet_df$Betweenness + 0.03

node.size<-setNames(bet_df$Betweenness*30,bet_df$name)

plot(g1, layout = layout_with_kk(g1)*0.7, label.cex = 0.5, vertex.size = node.size,vertex.label.color = "darkgrey")

dev.off()

```

NEWSCHOOL_BETWEENESS_BY USE

```{r}

g1 <- graph_from_data_frame(d=newdata_,directed = FALSE)
l = layout_as_tree(g1,flip.y=TRUE,root= "(A2) Main Lobby L2", circular = TRUE)

#plot(g1,layout=l, Vertex.label = NA)

#Edge Color
E(g1)$color <- 'black'
E(g1)$color[E(g1)$BlockConn != "-"] <- 'orange'
E(g1)$color[E(g1)$Staircase != "-"] <- 'orange'

#Node Color 
classroom = grep("Classroom",V(g1)$name)
facil = grep("Pool|Hall|Field|Canteen|Tennis|Sports|MPH|Cafe" ,V(g1)$name)
labs = grep("Play|Cafe|Lab|Suite|PlayCourt|PlayArea|Science|Design|Drama|Practice|Tennis|Basketball|Library" ,V(g1)$name)
ancillary = grep("Changing|Toilet|Wash|Store|Pantry" ,V(g1)$name)
entrance = grep("Visitor Car|Drop-Off|Drop|Sheltered" ,V(g1)$name)


V(g1)$color<-"darkgrey"
V(g1)[classroom]$color<-"red"
V(g1)[ancillary]$color<-"cornflowerblue"
V(g1)[ancillary]$color<-"azure2"
V(g1)[labs]$color<-"violet"
V(g1)[facil]$color<-"chartreuse1"
V(g1)[entrance]$color<-"black"


#------------------------------ Betweeness Kamada Kawai

tiff(filename="(NEW) Betweeness by Use.tiff", width=10, height=10, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)
     
bet = betweenness(g1, v = V(g1), directed = FALSE, weights = NULL,
  nobigint = TRUE, normalized = TRUE)

bet_df = as.data.frame(bet)
bet_df = setNames(cbind(rownames(bet_df), bet_df, row.names = NULL), 
         c("Name", "Betweenness"))

bet_df$Betweenness  = bet_df$Betweenness + 0.03

node.size<-setNames(bet_df$Betweenness*30,bet_df$name)

plot(g1, layout = layout_with_kk(g1)*0.7, label.cex = 0.5, vertex.size = node.size,vertex.label.color = "darkgrey")

dev.off()

```


NEW_OLD SCHOOL

```{r, fig.width = 50, fig.length = 50, fig.asp = .62}
g1 <- graph_from_data_frame(d=newdata_,directed = FALSE)
l = layout_as_tree(g1,flip.y=TRUE,root= "(A2) Main Lobby L2", circular = TRUE)

#plot(g1,layout=l, Vertex.label = NA)

#Edge Color
E(g1)$color <- 'black'
E(g1)$color[E(g1)$BlockConn != "-"] <- 'orange'
E(g1)$color[E(g1)$Staircase != "-"] <- 'orange'

#Node Color 
a = grep("(A1)|(A2)|(A3)|(A4)|(A5)|(A6)",V(g1)$name)
b = grep("(B1)|(B2)|(B3)|(B4)|(B5)|(B6)",V(g1)$name)
c = grep("(C1)|(C2)|(C3)|(C4)|(C5)|(C6)",V(g1)$name)
d = grep("(D1)|(D2)|(D3)|(D4)|(D5)|(D6)",V(g1)$name)
e = grep("(E1)|(E2)|(E3)|(E4)|(E5)|(E6)",V(g1)$name)
w = grep("(W1)|(W2)|(W3)|(W4)|(W5)|(W6)",V(g1)$name)
entrance = grep("Visitor Car|Drop-Off|Drop|Sheltered" ,V(g1)$name)


V(g1)$color<-"black"
V(g1)[a]$color<-"white"
V(g1)[b]$color<-"white"
V(g1)[c]$color<-"white"
V(g1)[d]$color<-"white"
V(g1)[e]$color<-"darkgrey"
V(g1)[w]$color<-"darkgoldenrod"
V(g1)[entrance]$color<-"black"
#Plot"

#------------------------------ PLOT

tiff(filename="(NEW) Existing vs New.tiff", width=10, height=10, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)

plot(g1, layout = layout_with_kk(g1)*0.1, vertex.size = 3, vertex.label.color = "darkgrey")

dev.off()

```


NEWSCHOOL_CLASSROOM DISTANCE _ BY FUNCTION
#BASE

```{r, fig.width = 50, fig.length = 50, fig.asp = .62}
g1 <- graph_from_data_frame(d=newdata_,directed = FALSE)
l = layout_as_tree(g1,flip.y=TRUE,root= "(A2) Main Lobby L2", circular = TRUE)

#plot(g1,layout=l, Vertex.label = NA)

#Edge Color
E(g1)$color <- 'black'
E(g1)$color[E(g1)$BlockConn != "-"] <- 'orange'
E(g1)$color[E(g1)$Staircase != "-"] <- 'orange'

#Node Color 
classroom = grep("Classroom",V(g1)$name)
facil = grep("Pool|Hall|Field|Canteen|Tennis|Sports|MPH|Cafe" ,V(g1)$name)
labs = grep("Play|Cafe|Lab|Suite|PlayCourt|PlayArea|Science|Design|Drama|Practice|Tennis|Basketball|Library" ,V(g1)$name)
ancillary = grep("Changing|Toilet|Wash|Store|Pantry" ,V(g1)$name)
entrance = grep("Visitor Car|Drop-Off|Drop|Sheltered" ,V(g1)$name)


V(g1)$color<-"darkgrey"
V(g1)[classroom]$color<-"red"
V(g1)[ancillary]$color<-"cornflowerblue"
V(g1)[ancillary]$color<-"azure2"
V(g1)[labs]$color<-"violet"
V(g1)[facil]$color<-"chartreuse1"
V(g1)[entrance]$color<-"black"

#------------------------------ PLOT

tiff(filename="(NEW) Default.tiff", width=10, height=10, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)

plot(g1, layout = layout_with_kk(g1)*0.1, vertex.size = 3, vertex.label.color = "darkgrey")

dev.off()

```



NEWSCHOOL_CLASSROOM DISTANCE _ BY SHARED FACILITIES
#Proximity of Classrooms to Shared Facilities

```{r, fig.width = 50, fig.length = 50, fig.asp = .62}
g1 <- graph_from_data_frame(d=newdata_,directed = FALSE)
l = layout_as_tree(g1,flip.y=TRUE,root= "(A2) Main Lobby L2", circular = TRUE)

#plot(g1,layout=l, Vertex.label = NA)

#Edge Color
E(g1)$color <- 'black'
E(g1)$color[E(g1)$BlockConn != "-"] <- 'orange'
E(g1)$color[E(g1)$Staircase != "-"] <- 'orange'

#Node Color 
classroom = grep("Classroom",V(g1)$name)
facil = grep("Pool|Hall|Field|Canteen|Tennis|Sports|MPH|Cafe" ,V(g1)$name)
labs = grep("Play|Cafe|Lab|Suite|PlayCourt|PlayArea|Science|Design|Drama|Practice|Tennis|Basketball|Library" ,V(g1)$name)
ancillary = grep("Changing|Toilet|Wash|Store|Pantry" ,V(g1)$name)
#facil = grep("Pool|Play|Cafe|Lab|Hall|Suite|PlayCourt|PlayArea|Science|Design|Drama|Practice|Field|Canteen|E-Sports|MPH" ,V(g1)$name)
entrance = grep("Visitor Car|Drop-Off|Drop|Sheltered" ,V(g1)$name)


V(g1)$color<-"darkgrey"
V(g1)[classroom]$color<-"red"
#V(g1)[ancillary]$color<-"cornflowerblue"
#V(g1)[ancillary]$color<-"azure2"
#V(g1)[labs]$color<-"violet"
V(g1)[facil]$color<-"chartreuse1"
#V(g1)[entrance]$color<-"black"

#------------------------------ PLOT

tiff(filename="(NEW) Classrooms to Facil.tiff", width=10, height=10, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)


name_df = data.frame(V(g1)$name) %>%
  mutate(size=3 )
name_df[grep("Classroom|Pool|Hall|Field|Canteen|Tennis|Sports|MPH|Library|Cafe", name_df$V.g1..name),]$size = 5
node.size<-setNames(name_df$size,name_df$V.g1..name)


plot(g1, layout = layout_with_kk(g1)*0.1, vertex.size = node.size, vertex.label.color = "darkgrey")

dev.off()




```

NEWSCHOOL_CLASSROOM DISTANCE _ BY DROP OFF
#Proximity of Classrooms to Drop Off

```{r, fig.width = 50, fig.length = 50, fig.asp = .62}
g1 <- graph_from_data_frame(d=newdata_,directed = FALSE)
l = layout_as_tree(g1,flip.y=TRUE,root= "(A2) Main Lobby L2", circular = TRUE)

#plot(g1,layout=l, Vertex.label = NA)

#Edge Color
E(g1)$color <- 'black'
E(g1)$color[E(g1)$BlockConn != "-"] <- 'orange'
E(g1)$color[E(g1)$Staircase != "-"] <- 'orange'

#Node Color 
classroom = grep("Classroom",V(g1)$name)
facil = grep("Pool|Hall|Field|Canteen|Tennis|Sports|MPH|Cafe" ,V(g1)$name)
labs = grep("Play|Cafe|Lab|Suite|PlayCourt|PlayArea|Science|Design|Drama|Practice|Tennis|Basketball|Library" ,V(g1)$name)
ancillary = grep("Changing|Toilet|Wash|Store|Pantry" ,V(g1)$name)
#facil = grep("Pool|Play|Cafe|Lab|Hall|Suite|PlayCourt|PlayArea|Science|Design|Drama|Practice|Field|Canteen|E-Sports|MPH" ,V(g1)$name)
entrance = grep("Visitor Car|Drop-Off|Drop|Sheltered" ,V(g1)$name)


V(g1)$color<-"darkgrey"
V(g1)[classroom]$color<-"red"
#V(g1)[ancillary]$color<-"cornflowerblue"
#V(g1)[ancillary]$color<-"azure2"
#V(g1)[labs]$color<-"violet"
#V(g1)[facil]$color<-"chartreuse1"
V(g1)[entrance]$color<-"black"

#------------------------------ PLOT

tiff(filename="(NEW) Classrooms to Dropoff.tiff", width=10, height=10, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)


name_df = data.frame(V(g1)$name) %>%
  mutate(size=3 )
name_df[grep("Classroom|Visitor Car|Drop-Off|Drop|Sheltered", name_df$V.g1..name),]$size = 5
node.size<-setNames(name_df$size,name_df$V.g1..name)



plot(g1, layout = layout_with_kk(g1)*0.1, vertex.size = node.size, vertex.label.color = "darkgrey")

dev.off()


```















```{r}

tiff(filename="(NEW)f_Network Plot (nicely).tiff", width=10, height=10, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)

plot(g1, layout = layout_nicely, vertex.size = 2, vertex.label.color = "darkgrey")


dev.off()






tiff(filename="(NEW)f_Network Plot (fr).tiff", width=10, height=10, units="in",
     pointsize=4, compression="lzw", bg="white", res=600,
     restoreConsole=TRUE)

plot(g1, layout = layout_with_fr(g1), vertex.label.color = "darkgrey", vertex.size = 2)


dev.off()
```


